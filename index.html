<!DOCTYPE html>
<html lang="es">
<head>
    <meta name="google-site-verification" content="6zd91WNH2MqWQZZNIHkQ3hzF7qeCTlM1tNhQyR2EKYU" />
    <meta name="keywords" content="retro games, juegos retro, arcade online, tetris, snake, breakout, juegos gratis">
    <link rel="canonical" href="https://retrogames.ink">
    <meta name="robots" content="index, follow">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Juega a los mejores juegos retro online gratis. Breakout, Space Invaders, Snake, Tetris y muchos m√°s. Sin descargas.">
    <title>Retro Games ‚Ä¢ Juegos Retro Online Gratis</title>
    <link rel="stylesheet" href="style.css">
   <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8061529160315518"
     crossorigin="anonymous"></script>
</head>
<body>
    <header>
        <h1>üéÆ Retro Arcade üéÆ</h1>
    </header>

    <main class="game-grid">
        <div class="game-card" data-game="games/pinball/juego1.html">
            <img src="images/Juego1.png" alt="Juego 1">
        </div>
        <div class="game-card" data-game="games/car/index.html">
            <img src="images/Juego2.png" alt="Juego 2">
        </div>
        <div class="game-card" data-game="games/breakout/index.html">
            <img src="images/Juego3.png" alt="Juego 3">
        </div>
        <div class="game-card" data-game="games/pong/index.html">
            <img src="images/Juego4.png" alt="Juego 4">
        </div>
        <div class="game-card" data-game="games/snake/index.html">
            <img src="images/Juego5.png" alt="Juego 4">
        </div>
        <div class="game-card" data-game="games/frogger/index.html">
            <img src="images/Juego6.png" alt="Juego 4">
        </div>
        <div class="game-card" data-game="games/spaceinvaders/index.html">
            <img src="images/Juego7.png" alt="Juego 4">
        </div>
        <div class="game-card" data-game="games/tetris/index.html">
            <img src="images/Juego8.png" alt="Juego 4">
        </div>
        <div class="game-card" data-game="games/memory/index.html">
            <img src="images/Juego9.png" alt="Juego 4">
        </div>
        <div class="game-card" data-game="games/whacamole/index.html">
            <img src="images/Juego10.png" alt="Juego 4">
        </div>
        
    </main>

    <!-- Modal -->
    <div id="gameModal">
        <div class="modal-content">
            <span id="closeModal">&times;</span>
            <div class="crt-overlay"></div>
            <iframe id="gameFrame" src="" frameborder="0"></iframe>
        </div>
    </div>
    <!-- Login / Perfil minimal -->
<div id="playerPanel" style="position:fixed;top:12px;right:12px;z-index:999;">
  <button id="openLoginBtn" class="btn">Identif√≠cate</button>
  <span id="playerName" style="margin-left:8px;"></span>
</div>

<!-- Popup logro -->
<div id="achievementPopup" style="position:fixed;bottom:20px;right:20px;z-index:9999;display:none;padding:12px;border:3px solid #a0522d;background:#fff3e0;border-radius:8px;font-family:'Press Start 2P';"></div>

<!-- Panel Logros -->
<div id="achievementsPanel" class="overlay hidden">
  <h2>Arcade Awards</h2>
  <ul id="achievementsList" style="list-style:none;padding:0;"></ul>
  <button id="closeAchievements" class="btn">Cerrar</button>
</div>

<!-- Panel Ranking -->
<div id="leaderboardPanel" class="overlay hidden">
  <h2>Ranking Global</h2>
  <div id="leaderboardContent"></div>
  <button id="closeLeaderboard" class="btn">Cerrar</button>
</div>

<!-- Modal Login -->
<div id="loginModal" class="overlay hidden">
  <h2>Identif√≠cate</h2>
  <input id="loginName" placeholder="Tu apodo (ej: Lucas)" style="padding:8px;border-radius:6px;border:2px solid #a0522d;">
  <div style="margin-top:12px;">
    <button id="saveLogin" class="btn">Guardar</button>
    <button id="closeLogin" class="btn">Cerrar</button>
  </div>
</div>


    <script src="script.js"></script>
    <!-- BLOQUE DE ANUNCIO -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-TU-ID-AQUI"
     data-ad-slot="1234567890"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script type="module">
/* -------------- CONFIG ----------------- */
const SUPABASE_URL = 'https://gowgclioxsdmgugmydmv.supabase.co'; // pon tu URL
const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imdvd2djbGlveHNkbWd1Z215ZG12Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI0MzAwMjUsImV4cCI6MjA3ODAwNjAyNX0.tHXcV_Ks351TZBdfTCQbo0QQxumi8QUFlJLP8Vu8H2Y'; // pon tu anon key

/* -------------- Supabase client (lite) --------------- */
import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';

const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

/* -------------- Utilidades de UI --------------- */
const loginModal = document.getElementById('loginModal');
const openLoginBtn = document.getElementById('openLoginBtn');
const closeLogin = document.getElementById('closeLogin');
const saveLogin = document.getElementById('saveLogin');
const loginName = document.getElementById('loginName');
const playerNameEl = document.getElementById('playerName');

const achievementPopup = document.getElementById('achievementPopup');
const achievementsPanel = document.getElementById('achievementsPanel');
const achievementsList = document.getElementById('achievementsList');
const closeAchievements = document.getElementById('closeAchievements');

const leaderboardPanel = document.getElementById('leaderboardPanel');
const leaderboardContent = document.getElementById('leaderboardContent');
const closeLeaderboard = document.getElementById('closeLeaderboard');

openLoginBtn.onclick = () => { loginModal.classList.remove('hidden'); loginModal.style.display='flex'; };
closeLogin.onclick = () => { loginModal.classList.add('hidden'); loginModal.style.display='none'; };
closeAchievements.onclick = () => { achievementsPanel.classList.add('hidden'); };
closeLeaderboard.onclick = () => { leaderboardPanel.classList.add('hidden'); };

/* -------------- Estado local ---------------- */
let PLAYER = {
  id: null,       // uuid
  username: null
};

/* Cargar jugador desde localStorage */
function loadPlayer() {
  const raw = localStorage.getItem('rg_player');
  if (raw) {
    PLAYER = JSON.parse(raw);
    playerNameEl.textContent = PLAYER.username ? `üë§ ${PLAYER.username}` : '';
  }
}
loadPlayer();

/* Guardar jugador local y en Supabase (upsert) */
async function savePlayer(name) {
  name = name.trim().substring(0, 24) || 'Jugador';
  // si ya tenemos id -> usar, si no generar uuid
  let id = PLAYER.id || crypto.randomUUID();
  PLAYER = { id, username: name };
  localStorage.setItem('rg_player', JSON.stringify(PLAYER));
  playerNameEl.textContent = `üë§ ${name}`;
  // Upsert en Supabase users
  try {
    await supabase
      .from('users')
      .upsert([{ id: PLAYER.id, username: PLAYER.username }], { onConflict: 'id' });
  } catch (e) {
    console.warn('Supabase user upsert error', e);
  }
}

/* Bot√≥n guardar login */
saveLogin.onclick = async () => {
  const name = loginName.value || 'Jugador';
  await savePlayer(name);
  loginModal.classList.add('hidden');
};

/* Si no hay player, abrir login */
if (!PLAYER.id || !PLAYER.username) {
  loginModal.classList.remove('hidden');
  loginModal.style.display='flex';
}

/* -------------- ACHIEVEMENTS (local + sync) ---------------- */

const ACHIEVEMENTS = [
  { id: 'first_play', name: 'Primer Jugador', description: 'Juega 1 partida', game_id: 'global' },
  { id: 'score_100', name: '100 puntos', description: 'Consigue 100 puntos en cualquier juego', game_id: 'global' },
  { id: 'pinball_master', name: 'Maestro Pinball', description: '5000 puntos en Pinball', game_id: 'pinball' },
  { id: 'snake_xl', name: 'Serpiente XL', description: '30 segmentos en Snake', game_id: 'snake' },
  // a√±ade los que quieras...
];

function getUnlockedLocal() {
  try {
    return JSON.parse(localStorage.getItem('rg_achievements') || '[]');
  } catch { return []; }
}
function setUnlockedLocal(list) {
  localStorage.setItem('rg_achievements', JSON.stringify(list));
}

/* Muestra popup logro */
function showAchievementPopup(ach) {
  achievementPopup.innerHTML = `üèÜ <strong>${ach.name}</strong><br><small>${ach.description}</small>`;
  achievementPopup.style.display = 'block';
  achievementPopup.style.opacity = '1';
  setTimeout(()=> {
    achievementPopup.style.transition = 'opacity 0.6s';
    achievementPopup.style.opacity = '0';
    setTimeout(()=> achievementPopup.style.display='none', 600);
  }, 2200);
}

/* Desbloquear logro localmente y en supabase */
async function unlockAchievement(achievementId, extra = {}) {
  const ach = ACHIEVEMENTS.find(a => a.id === achievementId);
  if(!ach) return;
  const unlocked = getUnlockedLocal();
  if(unlocked.includes(achievementId)) return; // ya desbloqueado

  unlocked.push(achievementId);
  setUnlockedLocal(unlocked);
  showAchievementPopup(ach);

  // Sincronizar con Supabase (registro global)
  if (PLAYER && PLAYER.id) {
    try {
      await supabase.from('achievements_unlocked').insert([{
        user_id: PLAYER.id,
        username: PLAYER.username,
        achievement_id: ach.id,
        achievement_name: ach.name,
        game_id: ach.game_id
      }]);
    } catch (e) {
      console.warn('Error sync achievement', e);
    }
  }
}

/* Mostrar panel de logros */
function openAchievementsPanel() {
  achievementsList.innerHTML = '';
  const unlocked = getUnlockedLocal();
  ACHIEVEMENTS.forEach(a => {
    const li = document.createElement('li');
    li.innerHTML = `${unlocked.includes(a.id) ? '‚úÖ' : '‚ùå'} <strong>${a.name}</strong> - <small>${a.description}</small>`;
    achievementsList.appendChild(li);
  });
  achievementsPanel.classList.remove('hidden');
}

/* -------------- LEADERBOARD / SCORE SYNC ---------------- */

/**
 * submitScore(gameId, score)
 * - Inserta score en Supabase
 * - Llama a unlockAchievement si corresponde
 */
async function submitScore(gameId, score) {
  // Guardar local: opcional
  try {
    await supabase.from('scores').insert([{
      user_id: PLAYER.id,
      username: PLAYER.username,
      game_id: gameId,
      score: score
    }]);
  } catch (e) {
    console.warn('Error enviar score', e);
  }

  // Ejemplo: chequear logros globales
  if (score >= 100) await unlockAchievement('score_100');
  if (gameId === 'pinball' && score >= 5000) await unlockAchievement('pinball_master');
  if (gameId === 'snake' && score >= 30) await unlockAchievement('snake_xl');
}

/* Obtener top N para un juego */
async function fetchLeaderboard(gameId, limit = 10) {
  try {
    const { data, error } = await supabase
      .from('scores')
      .select('username, score, created_at')
      .eq('game_id', gameId)
      .order('score', { ascending: false })
      .limit(limit);
    if (error) throw error;
    return data || [];
  } catch (e) {
    console.warn('fetchLeaderboard error', e);
    return [];
  }
}

/* Mostrar panel del leaderboard */
async function openLeaderboard(gameId) {
  const list = await fetchLeaderboard(gameId);
  leaderboardContent.innerHTML = `<h3>${gameId.toUpperCase()}</h3>`;
  const table = document.createElement('ol');
  list.forEach(row => {
    const li = document.createElement('li');
    li.innerHTML = `${row.username || 'Anon'} ‚Äî <strong>${row.score}</strong>`;
    table.appendChild(li);
  });
  leaderboardContent.appendChild(table);
  leaderboardPanel.classList.remove('hidden');
}

/* -------------- Helpers para integrar en tus juegos ------------- */

/* Llamar esto cuando termina una partida:
   submitScore('pinball', 1200)
*/
window.RG = {
  submitScore,
  unlockAchievement,
  openAchievementsPanel,
  openLeaderboard,
  savePlayer // permite cambiar nombre
};

/* -------------- Inicializaci√≥n visual -------------- */
document.addEventListener('DOMContentLoaded', () => {
  loadPlayer();
  // Actualiza el nombre si ya est√°
  if (PLAYER.username) playerNameEl.textContent = `üë§ ${PLAYER.username}`;
  // Atachar botones (si los tienes en el men√∫)
  // Ejemplo: document.getElementById('achBtn').onclick = () => openAchievementsPanel();
});
    (adsbygoogle = window.adsbygoogle || []).push({});
</script>

    
</body>
</html>
